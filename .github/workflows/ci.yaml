name: CI

on:
  pull_request:
    branches:
      - main
      - dev

permissions:
  contents: read
  id-token: write

env:
  # Set environment based on branch
  # If it's main branch, use 'production', else 'development'
  DEPLOYMENT_ENVIRONMENT: ${{ github.ref == 'refs/heads/main' && 'production' || 'development' }}

jobs:
  ci:
    environment: ${{ github.ref == 'refs/heads/main' && 'production' || 'development' }}
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [ubuntu-22.04]

    steps:
    - uses: actions/checkout@v5

    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '22'
        cache: 'npm'

    # - name: Install Dependencies
    #   run: npm ci

    - name: Display Execution Context
      run: |
        echo "::group::Execution Context"
        echo "Environment: ${{ env.DEPLOYMENT_ENVIRONMENT }}"
        echo "GitHub Ref: ${{ github.ref }}"
        echo "GitHub Event: ${{ github.event_name }}"
        echo "Node.js version: $(node --version)"
        echo "npm version: $(npm --version)"
        echo "::endgroup::"

    # - name: Code Formatting Check (Biome)
    #   run: npx @biomejs/biome check --error-on-warnings .

    # - name: Static Type Checking
    #   run: npx tsc --noEmit

    # - name: Build Check
    #   run: npm run build
